<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Abjurer Tracker - D&D HP Management</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="manifest.json">
    
    <!-- iOS Specific -->
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
    <meta name="apple-mobile-web-app-title" content="Abjurer Tracker">
    <link rel="apple-touch-icon" href="data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'%3E%3Ccircle cx='50' cy='50' r='45' fill='%234c63d2'/%3E%3Ctext x='50' y='60' font-family='Arial' font-size='40' text-anchor='middle' fill='white'%3Eüõ°Ô∏è%3C/text%3E%3C/svg%3E">
    
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <div class="container">
        <header>
            <h1>üõ°Ô∏è Abjurer Tracker</h1>
            <p>D&D HP Management System</p>
        </header>

        <main>
            <div class="hp-categories">
                <!-- Arcane Ward -->
                <div class="hp-category arcane-ward">
                    <h2>‚ö° Arcane Ward</h2>
                    <div class="hp-display">
                        <span class="current-hp" id="arcane-current">0</span>
                        <span class="separator">/</span>
                        <span class="max-hp" id="arcane-max">18</span>
                    </div>
                    <div class="hp-bar">
                        <div class="hp-fill" id="arcane-fill"></div>
                    </div>
                    <div class="damage-absorbed">
                        <span class="damage-absorbed-amount" id="arcane-absorbed">0</span>
                        <span class="damage-absorbed-label">Damage Absorbed</span>
                    </div>
                    <div class="controls">
                        <input type="number" class="hp-input" id="arcane-input" value="1" min="1" inputmode="numeric">
                        <button class="btn btn-add" onclick="modifyHPByInput('arcane', true)">Add</button>
                        <button class="btn btn-subtract" onclick="modifyHPByInput('arcane', false)">Subtract</button>
                        <button class="btn btn-reset" onclick="resetCategory('arcane')">Reset</button>
                        <button class="btn btn-reset-absorbed" onclick="resetDamageAbsorbed('arcane')">Reset Counter</button>
                    </div>
                    <div class="max-controls">
                        <label for="arcane-max-input">Max HP:</label>
                        <input type="number" id="arcane-max-input" min="0" value="18" onchange="updateMaxHP('arcane', this.value)">
                    </div>
                </div>

                <!-- Shielding Reservoir -->
                <div class="hp-category shielding-reservoir">
                    <h2>üîÆ Shielding Reservoir</h2>
                    <div class="hp-display">
                        <span class="current-hp" id="reservoir-current">0</span>
                        <span class="separator">/ ‚àû</span>
                    </div>
                    <div class="damage-absorbed">
                        <span class="damage-absorbed-amount" id="reservoir-absorbed">0</span>
                        <span class="damage-absorbed-label">Damage Absorbed</span>
                    </div>
                    <div class="controls">
                        <input type="number" class="hp-input" id="reservoir-input" value="1" min="1" inputmode="numeric">
                        <button class="btn btn-add" onclick="modifyHPByInput('reservoir', true)">Add</button>
                        <button class="btn btn-subtract" onclick="modifyHPByInput('reservoir', false)">Subtract</button>
                        <button class="btn btn-reset" onclick="resetCategory('reservoir')">Reset</button>
                        <button class="btn btn-reset-absorbed" onclick="resetDamageAbsorbed('reservoir')">Reset Counter</button>
                    </div>
                </div>

                <!-- Main HP -->
                <div class="hp-category main-hp">
                    <h2>‚ù§Ô∏è Main HP</h2>
                    <div class="hp-display">
                        <span class="current-hp" id="main-current">0</span>
                        <span class="separator">/</span>
                        <span class="max-hp" id="main-max">57</span>
                    </div>
                    <div class="hp-bar">
                        <div class="hp-fill" id="main-fill"></div>
                    </div>
                    <div class="controls">
                        <input type="number" class="hp-input" id="main-input" value="1" min="1" inputmode="numeric">
                        <button class="btn btn-add" onclick="modifyHPByInput('main', true)">Add</button>
                        <button class="btn btn-subtract" onclick="modifyHPByInput('main', false)">Subtract</button>
                        <button class="btn btn-reset" onclick="resetCategory('main')">Reset</button>
                    </div>
                    <div class="max-controls">
                        <label for="main-max-input">Max HP:</label>
                        <input type="number" id="main-max-input" min="0" value="57" onchange="updateMaxHP('main', this.value)">
                    </div>
                </div>
            </div>

            <div class="actions-container">
                <div class="spell-recharge-section">
                    <h2>‚ú® Spell Recharging</h2>
                    <p>Recharge your defenses when casting spells</p>
                    
                    <div class="spell-controls">
                        <div class="spell-inputs-row">
                            <div class="spell-input-group">
                                <label for="spell-level">Spell Level:</label>
                                <input type="number" id="spell-level" min="1" max="9" value="1" inputmode="numeric">
                            </div>
                            
                            <div class="spell-input-group">
                                <label for="int-modifier">INT Modifier:</label>
                                <input type="number" id="int-modifier" min="0" max="10" value="4" inputmode="numeric">
                            </div>
                        </div>
                        
                        <div class="spell-buttons">
                            <button class="btn btn-spell-arcane" onclick="rechargeFromSpell('arcane')">
                                ‚ö° Recharge Arcane Ward<br>
                                <small>(Spell Level √ó 2)</small>
                            </button>
                            <button class="btn btn-spell-reservoir" onclick="rechargeFromSpell('reservoir')">
                                üîÆ Recharge Reservoir<br>
                                <small>(Set to Spell Level + INT Mod)</small>
                            </button>
                            <button class="btn btn-spell-both" onclick="rechargeFromSpell('both')">
                                ‚ú® Recharge Both<br>
                                <small>(Abjuration Spell)</small>
                            </button>
                        </div>
                    </div>
                </div>

                <div class="damage-section">
                    <h2>üí• Take Damage</h2>
                    <p>Damage will be applied in order: Arcane Ward ‚Üí Shielding Reservoir ‚Üí Main HP</p>
                    <div class="damage-controls">
                        <input type="number" id="damage-amount" min="1" value="1" placeholder="Damage amount">
                        <button class="btn btn-damage" onclick="takeDamage()">Apply Damage</button>
                    </div>
                </div>
            </div>

            <div class="party-tracking">
                <h2>üë• Party Protection Tracking</h2>
                <p>Track damage you've prevented for each party member</p>
                
                <div class="add-member-section">
                    <input type="text" id="new-member-name" placeholder="Enter party member name" maxlength="20">
                    <button class="btn btn-add" onclick="addPartyMember()">Add Member</button>
                </div>
                
                <div class="party-members" id="party-members">
                    <!-- Party members will be dynamically added here -->
                </div>
            </div>

            <div class="special-abilities">
                <h2>üåü Special Abilities</h2>
                
                <div class="ability-card">
                    <h3>‚≠ê Fortune From the Many</h3>
                    <p class="ability-description">
                        If you miss with an attack roll or fail an ability check or a saving throw, you can draw on your bonds of reciprocity to gain a bonus to the roll equal to the number of allies you can see within 30 feet of you (maximum bonus of +3). You can use this trait a number of times equal to your proficiency bonus, and you regain all expended uses when you finish a long rest.
                    </p>
                    
                    <div class="ability-usage">
                        <div class="usage-header">
                            <span class="usage-label">Uses Remaining:</span>
                            <span class="usage-count" id="fortune-remaining">3</span>
                            <span class="usage-total">/ 3</span>
                        </div>
                        
                        <div class="usage-checkboxes" id="fortune-checkboxes">
                            <div class="checkbox-item">
                                <input type="checkbox" id="fortune-use-1" onchange="updateFortuneUsage()">
                                <label for="fortune-use-1">Use 1</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="fortune-use-2" onchange="updateFortuneUsage()">
                                <label for="fortune-use-2">Use 2</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="fortune-use-3" onchange="updateFortuneUsage()">
                                <label for="fortune-use-3">Use 3</label>
                            </div>
                        </div>
                        
                        <div class="ability-controls">
                            <button class="btn btn-long-rest" onclick="resetFortuneUses()">Long Rest Reset</button>
                        </div>
                    </div>
                </div>

                <div class="ability-card">
                    <h3>üßö Fey Gift</h3>
                    <p class="ability-description">
                        You can use this trait to take the Help action as a bonus action, and you can do so a number of times equal to your proficiency bonus. You regain all expended uses when you finish a long rest.
                        <br><br>
                        <strong>Starting at 3rd level, choose one of the options below each time you take the Help action with this trait:</strong>
                        <br>‚Ä¢ <strong>Hospitality:</strong> You and the creature you help each gain a number of temporary hit points equal to 1d6 plus your proficiency bonus.
                        <br>‚Ä¢ <strong>Passage:</strong> You and the creature you help each increase your walking speeds by 10 feet until the start of your next turn.
                        <br>‚Ä¢ <strong>Spite:</strong> Until the start of your next turn, the first time the creature you help hits a target with an attack roll, that target has disadvantage on the next attack roll it makes within the next minute.
                    </p>
                    
                    <div class="ability-usage">
                        <div class="usage-header">
                            <span class="usage-label">Uses Remaining:</span>
                            <span class="usage-count" id="fey-gift-remaining">3</span>
                            <span class="usage-total">/ 3</span>
                        </div>
                        
                        <div class="usage-checkboxes" id="fey-gift-checkboxes">
                            <div class="checkbox-item">
                                <input type="checkbox" id="fey-gift-use-1" onchange="updateFeyGiftUsage()">
                                <label for="fey-gift-use-1">Use 1</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="fey-gift-use-2" onchange="updateFeyGiftUsage()">
                                <label for="fey-gift-use-2">Use 2</label>
                            </div>
                            <div class="checkbox-item">
                                <input type="checkbox" id="fey-gift-use-3" onchange="updateFeyGiftUsage()">
                                <label for="fey-gift-use-3">Use 3</label>
                            </div>
                        </div>
                        
                        <div class="ability-controls">
                            <button class="btn btn-long-rest" onclick="resetFeyGiftUses()">Long Rest Reset</button>
                        </div>
                    </div>
                </div>

                <div class="ability-card">
                    <h3>üèõÔ∏è Quick Ritual</h3>
                    <p class="ability-description">
                        With this benefit, you can cast a Ritual spell that you have prepared using its regular casting time rather than the extended time for a Ritual. Doing so doesn't require a spell slot. Once you cast the spell in this way, you can't use this benefit again until you finish a Long Rest.
                    </p>
                    
                    <div class="ability-usage">
                        <div class="usage-header">
                            <span class="usage-label">Uses Remaining:</span>
                            <span class="usage-count" id="quick-ritual-remaining">1</span>
                            <span class="usage-total">/ 1</span>
                        </div>
                        
                        <div class="usage-checkboxes">
                            <div class="checkbox-item">
                                <input type="checkbox" id="quick-ritual-use-1" onchange="updateQuickRitualUsage()">
                                <label for="quick-ritual-use-1">Used</label>
                            </div>
                        </div>
                        
                        <div class="ability-controls">
                            <button class="btn btn-long-rest" onclick="resetQuickRitualUses()">Long Rest Reset</button>
                        </div>
                    </div>
                </div>

                <div class="ability-card passive-ability">
                    <h3>üßö‚Äç‚ôÄÔ∏è Fey Ancestry</h3>
                    <p class="ability-description">
                        You have advantage on saving throws you make to avoid or end the charmed condition on yourself.
                    </p>
                    <div class="passive-indicator">Passive Ability</div>
                </div>

                <div class="ability-card passive-ability">
                    <h3>üëÅÔ∏è Darkvision</h3>
                    <p class="ability-description">
                        You can see in dim light within 60 feet of you as if it were bright light and in darkness as if it were dim light. You discern colors in that darkness only as shades of gray.
                    </p>
                    <div class="passive-indicator">Passive Ability</div>
                </div>

                <div class="ability-card passive-ability">
                    <h3>üß† Intelligence</h3>
                    <p class="ability-description">
                        Your Intelligence increases by 1 and any spells gained by this feat uses Intelligence as its spellcasting ability.
                    </p>
                    <div class="passive-indicator">Passive Ability</div>
                </div>
            </div>

            <div class="reset-all">
                <button class="btn btn-reset-all" onclick="resetAll()">Reset All HP</button>
                <button class="btn btn-reset-all" onclick="resetPartyTracking()">Reset Party Tracking</button>
                <button class="btn btn-reset-all" onclick="resetAllDamageAbsorbed()">Reset Damage Counters</button>
            </div>
        </main>

        <footer>
            <p>Made for D&D Abjuration Wizards üßô‚Äç‚ôÇÔ∏è</p>
        </footer>
    </div>

    <script src="script.js"></script>
</body>
</html>
